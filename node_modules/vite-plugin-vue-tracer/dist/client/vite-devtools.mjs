import { events, isEnabled } from 'vite-plugin-vue-tracer/client/listeners';
import { state } from 'vite-plugin-vue-tracer/client/overlay';

function enable(ctx) {
  events.on("click", (e) => {
    const base = import.meta.env?.BASE_URL || "/";
    fetch(`${base}__open-in-editor?file=${e.pos[0]}:${e.pos[1]}:${e.pos[2]}`);
    isEnabled.value = false;
    state.isVisible = false;
  });
  isEnabled.value = !isEnabled.value;
  state.isVisible = isEnabled.value;
  ctx.hidePanel();
  ctx.dockState = isEnabled.value ? "active" : "inactive";
}

export { enable as default };
